# Elixir Ingestion Pipeline

Elixir documentation centers on Hex.pm and ExDoc. Unlike Go where we parse source, Elixir documentation is distributed as pre-rendered HTML tarballs.

See also: [PIPELINE_GLEAM.md](./PIPELINE_GLEAM.md) for Gleam packages on Hex.pm (shared tarball infrastructure, different HTML structure).

## Source Acquisition

**URL Pattern**: `https://repo.hex.pm/docs/{package}-{version}.tar.gz`

Content is a static website generated by ExDoc.

## HTML-to-Markdown Conversion

ExDoc produces semantic, predictable HTML classes, making conversion reliable.

### Parsing Strategy

Use Goquery (Go port of jQuery) to traverse DOM:

- `#sidebar`: Navigation structure (Modules, Functions) maps to `search_index`
- `.content-inner`: Actual documentation content
- `.spec`: Type specifications (typespecs)

### Conversion Logic

Use `github.com/JohannesKaufmann/html-to-markdown` with custom plugins:

**Admonition Blocks**: Convert ExDoc Warnings/Tips to Markdown blockquotes with bold headers:

```markdown
> **Warning**
> Content here
```

**Code Blocks**: Strip syntax highlighting classes, produce standard fenced blocks:

```elixir
# code here
```

## Agent Context

Elixir relies on pattern matching and arity. The `agent_context.signature` must include arity (e.g., `start_link/3`).

**Data Source**: Parse `sidebar_items.json` from Hex tarball. This machine-readable index of modules and functions is more reliable than scraping HTML sidebar.

## Dependencies

- `repo.hex.pm` - Documentation tarballs
- `goquery` - HTML parsing
- `html-to-markdown` - Conversion library
